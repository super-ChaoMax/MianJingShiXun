import{i as we,j as J,t as U,n as z,k as Q,l as xe,m as oe,a as f,F as se,p as D,q as X,v as Te,x as Pe,y as Me,A as Be,C as Ae,D as Le,E as _e,r as G,G as Re,H as x,I as ne,J as Fe,K as Oe,L as $,M as $e,N as T,O as Ne,P as De,Q as H,R as W,S as We,T as ze,U as ae,f as qe,V as Y,W as je,X as Ge,Y as He,Z as Ke,$ as Ue,a0 as Ye}from"./index-IQsjkGjj.js";import{C as Je,c as Qe}from"./index-CQCvHenO.js";let Xe=0;function Ze(){const e=we(),{name:n="unknown"}=e?.type||{};return`${n}-${++Xe}`}const[pe,et]=Q("form"),tt={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:z,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:U,showErrorMessage:U,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var nt=J({name:pe,props:tt,emits:["submit","failed"],setup(e,{emit:n,slots:o}){const{children:c,linkChildren:r}=xe(se),u=a=>a?c.filter(s=>a.includes(s.name)):c,L=a=>new Promise((s,g)=>{const y=[];u(a).reduce((j,B)=>j.then(()=>{if(!y.length)return B.validate().then(A=>{A&&y.push(A)})}),Promise.resolve()).then(()=>{y.length?g(y):s()})}),P=a=>new Promise((s,g)=>{const y=u(a);Promise.all(y.map(b=>b.validate())).then(b=>{b=b.filter(Boolean),b.length?g(b):s()})}),v=a=>{const s=c.find(g=>g.name===a);return s?new Promise((g,y)=>{s.validate().then(b=>{b?y(b):g()})}):Promise.reject()},C=a=>typeof a=="string"?v(a):e.validateFirst?L(a):P(a),m=a=>{typeof a=="string"&&(a=[a]),u(a).forEach(g=>{g.resetValidation()})},q=()=>c.reduce((a,s)=>(a[s.name]=s.getValidationStatus(),a),{}),M=(a,s)=>{c.some(g=>g.name===a?(g.$el.scrollIntoView(s),!0):!1)},_=()=>c.reduce((a,s)=>(s.name!==void 0&&(a[s.name]=s.formValue.value),a),{}),R=()=>{const a=_();C().then(()=>n("submit",a)).catch(s=>{n("failed",{values:a,errors:s});const{scrollToError:g,scrollToErrorPosition:y}=e;g&&s[0].name&&M(s[0].name,y?{block:y}:void 0)})},w=a=>{D(a),R()};return r({props:e}),oe({submit:R,validate:C,getValues:_,scrollToField:M,resetValidation:m,getValidationStatus:q}),()=>{var a;return f("form",{class:et(),onSubmit:w},[(a=o.default)==null?void 0:a.call(o)])}}});const vt=X(nt);function ce(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function at(e,n){if(ce(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function it(e,n){return new Promise(o=>{const c=n.validator(e,n);if(Ae(c)){c.then(o);return}o(c)})}function ie(e,n){const{message:o}=n;return Be(o)?o(e,n):o||""}function lt({target:e}){e.composing=!0}function le({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function rt(e,n){const o=Te();e.style.height="auto";let c=e.scrollHeight;if(Pe(n)){const{maxHeight:r,minHeight:u}=n;r!==void 0&&(c=Math.min(c,r)),u!==void 0&&(c=Math.max(c,u))}c&&(e.style.height=`${c}px`,Me(o))}function ot(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function N(e){return[...e].length}function K(e,n){return[...e].slice(0,n).join("")}const[st,S]=Q("field"),ct={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:z,max:Number,min:Number,formatter:Function,clearIcon:W("clear"),modelValue:We(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:W("focus"),formatTrigger:W("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},ut=Le({},Qe,ct,{rows:z,type:W("text"),rules:Array,autosize:[Boolean,Object],labelWidth:z,labelClass:ze,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var dt=J({name:st,props:ut,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:o}){const c=Ze(),r=_e({status:"unvalidated",focused:!1,validateMessage:""}),u=G(),L=G(),P=G(),{parent:v}=Re(se),C=()=>{var t;return String((t=e.modelValue)!=null?t:"")},m=t=>{if(T(e[t]))return e[t];if(v&&T(v.props[t]))return v.props[t]},q=x(()=>{const t=m("readonly");if(e.clearable&&!t){const i=C()!=="",l=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return i&&l}return!1}),M=x(()=>P.value&&o.input?P.value():e.modelValue),_=x(()=>{var t;const i=m("required");return i==="auto"?(t=e.rules)==null?void 0:t.some(l=>l.required):i}),R=t=>t.reduce((i,l)=>i.then(()=>{if(r.status==="failed")return;let{value:d}=M;if(l.formatter&&(d=l.formatter(d,l)),!at(d,l)){r.status="failed",r.validateMessage=ie(d,l);return}if(l.validator)return ce(d)&&l.validateEmpty===!1?void 0:it(d,l).then(h=>{h&&typeof h=="string"?(r.status="failed",r.validateMessage=h):h===!1&&(r.status="failed",r.validateMessage=ie(d,l))})}),Promise.resolve()),w=()=>{r.status="unvalidated",r.validateMessage=""},a=()=>n("endValidate",{status:r.status,message:r.validateMessage}),s=(t=e.rules)=>new Promise(i=>{w(),t?(n("startValidate"),R(t).then(()=>{r.status==="failed"?(i({name:e.name,message:r.validateMessage}),a()):(r.status="passed",i(),a())})):i()}),g=t=>{if(v&&e.rules){const{validateTrigger:i}=v.props,l=ae(i).includes(t),d=e.rules.filter(h=>h.trigger?ae(h.trigger).includes(t):l);d.length&&s(d)}},y=t=>{var i;const{maxlength:l}=e;if(T(l)&&N(t)>+l){const d=C();if(d&&N(d)===+l)return d;const h=(i=u.value)==null?void 0:i.selectionEnd;if(r.focused&&h){const E=[...t],k=E.length-+l;return E.splice(h-k,k),E.join("")}return K(t,+l)}return t},b=(t,i="onChange")=>{var l,d;const h=t;t=y(t);const E=h.length-t.length;if(e.type==="number"||e.type==="digit"){const V=e.type==="number";if(t=Ne(t,V,V),i==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const I=De(+t,(l=e.min)!=null?l:-1/0,(d=e.max)!=null?d:1/0);+t!==I&&(t=I.toString())}}let k=0;if(e.formatter&&i===e.formatTrigger){const{formatter:V,maxlength:I}=e;if(t=V(t),T(I)&&N(t)>+I&&(t=K(t,+I)),u.value&&r.focused){const{selectionEnd:O}=u.value,te=K(h,O);k=V(te).length-te.length}}if(u.value&&u.value.value!==t)if(r.focused){let{selectionStart:V,selectionEnd:I}=u.value;if(u.value.value=t,T(V)&&T(I)){const O=t.length;E?(V-=E,I-=E):k&&(V+=k,I+=k),u.value.setSelectionRange(Math.min(V,O),Math.min(I,O))}}else u.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},j=t=>{t.target.composing||b(t.target.value)},B=()=>{var t;return(t=u.value)==null?void 0:t.blur()},A=()=>{var t;return(t=u.value)==null?void 0:t.focus()},F=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&rt(t,e.autosize)},ue=t=>{r.focused=!0,n("focus",t),$(F),m("readonly")&&B()},de=t=>{r.focused=!1,b(C(),"onBlur"),n("blur",t),!m("readonly")&&(g("onBlur"),$(F),je())},Z=t=>n("clickInput",t),fe=t=>n("clickLeftIcon",t),ge=t=>n("clickRightIcon",t),me=t=>{D(t),n("update:modelValue",""),n("clear",t)},p=x(()=>{if(typeof e.error=="boolean")return e.error;if(v&&v.props.showError&&r.status==="failed")return!0}),he=x(()=>{const t=m("labelWidth"),i=m("labelAlign");if(t&&i!=="top")return{width:ne(t)}}),be=t=>{t.keyCode===13&&(!(v&&v.props.submitOnEnter)&&e.type!=="textarea"&&D(t),e.type==="search"&&B()),n("keypress",t)},ee=()=>e.id||`${c}-input`,ve=()=>r.status,ye=()=>{const t=S("control",[m("inputAlign"),{error:p.value,custom:!!o.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(o.input)return f("div",{class:t,onClick:Z},[o.input()]);const i={id:ee(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:m("disabled"),readonly:m("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${c}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:de,onFocus:ue,onInput:j,onClick:Z,onChange:le,onKeypress:be,onCompositionend:le,onCompositionstart:lt};return e.type==="textarea"?f("textarea",Y(i,{inputmode:e.inputmode}),null):f("input",Y(ot(e.type,e.inputmode),i),null)},Se=()=>{const t=o["left-icon"];if(e.leftIcon||t)return f("div",{class:S("left-icon"),onClick:fe},[t?t():f(H,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ie=()=>{const t=o["right-icon"];if(e.rightIcon||t)return f("div",{class:S("right-icon"),onClick:ge},[t?t():f(H,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ve=()=>{if(e.showWordLimit&&e.maxlength){const t=N(C());return f("div",{class:S("word-limit")},[f("span",{class:S("word-num")},[t]),qe("/"),e.maxlength])}},Ce=()=>{if(v&&v.props.showErrorMessage===!1)return;const t=e.errorMessage||r.validateMessage;if(t){const i=o["error-message"],l=m("errorMessageAlign");return f("div",{class:S("error-message",l)},[i?i({message:t}):t])}},Ee=()=>{const t=m("labelWidth"),i=m("labelAlign"),l=m("colon")?":":"";if(o.label)return[o.label(),l];if(e.label)return f("label",{id:`${c}-label`,for:o.input?void 0:ee(),"data-allow-mismatch":"attribute",onClick:d=>{D(d),A()},style:i==="top"&&t?{width:ne(t)}:void 0},[e.label+l])},ke=()=>[f("div",{class:S("body")},[ye(),q.value&&f(H,{ref:L,name:e.clearIcon,class:S("clear")},null),Ie(),o.button&&f("div",{class:S("button")},[o.button()])]),Ve(),Ce()];return oe({blur:B,focus:A,validate:s,formValue:M,resetValidation:w,getValidationStatus:ve}),Ge(He,{customValue:P,resetValidation:w,validateWithTrigger:g}),Fe(()=>e.modelValue,()=>{b(C()),w(),g("onChange"),$(F)}),Oe(()=>{b(C(),e.formatTrigger),$(F)}),$e("touchstart",me,{target:x(()=>{var t;return(t=L.value)==null?void 0:t.$el})}),()=>{const t=m("disabled"),i=m("labelAlign"),l=Se(),d=()=>{const h=Ee();return i==="top"?[l,h].filter(Boolean):h||[]};return f(Je,{size:e.size,class:S({error:p.value,disabled:t,[`label-${i}`]:i}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:he.value,valueClass:S("value"),titleClass:[S("label",[i,{required:_.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:l&&i!=="top"?()=>l:null,title:d,value:ke,extra:o.extra})}}});const yt=X(dt),[ft,re]=Q("cell-group"),gt={title:String,inset:Boolean,border:U};var mt=J({name:ft,inheritAttrs:!1,props:gt,setup(e,{slots:n,attrs:o}){const c=()=>{var u;return f("div",Y({class:[re({inset:e.inset}),{[Ye]:e.border&&!e.inset}]},o,Ue()),[(u=n.default)==null?void 0:u.call(n)])},r=()=>f("div",{class:re("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?f(Ke,null,[r(),c()]):c()}});const St=X(mt);export{St as C,vt as F,yt as a};
