import{j as A,t as $,S as N,af as F,R as Q,k as W,H as D,ag as Y,a as h,ah as E,P as Z,q as G,_ as H,r as _,K as J,a6 as X,J as ee,ai as K,w as te,a3 as I,a4 as ae,e as o,Q as oe,aj as se,ak as ne,L as O,o as k,c as C,a1 as R,al as le,a5 as ce,am as re,a7 as U,Z as ie,an as ue,ao as z,d as de,a2 as M}from"./index-IQsjkGjj.js";import{B as ve}from"./index-CEmfl1C6.js";import{m as q}from"./mianjing-BRxc7wPw.js";const[me,S,j]=W("pagination"),L=(l,u,c)=>({number:l,text:u,active:c}),he={mode:Q("multi"),prevText:String,nextText:String,pageCount:N(0),modelValue:F(0),totalItems:N(0),showPageSize:N(5),itemsPerPage:N(10),forceEllipses:Boolean,showPrevButton:$,showNextButton:$};var pe=A({name:me,props:he,emits:["change","update:modelValue"],setup(l,{emit:u,slots:c}){const a=D(()=>{const{pageCount:s,totalItems:i,itemsPerPage:v}=l,r=+s||Math.ceil(+i/+v);return Math.max(1,r)}),b=D(()=>{const s=[],i=a.value,v=+l.showPageSize,{modelValue:r,forceEllipses:y}=l;let w=1,f=i;const B=v<i;B&&(w=Math.max(r-Math.floor(v/2),1),f=w+v-1,f>i&&(f=i,w=f-v+1));for(let g=w;g<=f;g++){const t=L(g,g,g===r);s.push(t)}if(B&&v>0&&y){if(w>1){const g=L(w-1,"...");s.unshift(g)}if(f<i){const g=L(f+1,"...");s.push(g)}}return s}),d=(s,i)=>{s=Z(s,1,a.value),l.modelValue!==s&&(u("update:modelValue",s),i&&u("change",s))};Y(()=>d(l.modelValue));const T=()=>h("li",{class:S("page-desc")},[c.pageDesc?c.pageDesc():`${l.modelValue}/${a.value}`]),P=()=>{const{mode:s,modelValue:i,showPrevButton:v}=l;if(!v)return;const r=c["prev-text"],y=i===1;return h("li",{class:[S("item",{disabled:y,border:s==="simple",prev:!0}),E]},[h("button",{type:"button",disabled:y,onClick:()=>d(i-1,!0)},[r?r():l.prevText||j("prev")])])},p=()=>{const{mode:s,modelValue:i,showNextButton:v}=l;if(!v)return;const r=c["next-text"],y=i===a.value;return h("li",{class:[S("item",{disabled:y,border:s==="simple",next:!0}),E]},[h("button",{type:"button",disabled:y,onClick:()=>d(i+1,!0)},[r?r():l.nextText||j("next")])])},m=()=>b.value.map(s=>h("li",{class:[S("item",{active:s.active,page:!0}),E]},[h("button",{type:"button","aria-current":s.active||void 0,onClick:()=>d(s.number,!0)},[c.page?c.page(s):s.text])]));return()=>h("nav",{role:"navigation",class:S()},[h("ul",{class:S("items")},[P(),l.mode==="simple"?T():m(),p()])])}});const ge=G(pe),fe={__name:"BackToBottom",props:{right:{type:String,default:"10vw"},bottom:{type:String,default:"20vh"},zIndex:{type:Number,default:99},threshold:{type:Number,default:200},target:{type:String,default:"body"}},setup(l){const u=l,c=_(!1);let a=null;const b=async()=>{await O(),a&&a.scrollTo({top:a.scrollHeight,behavior:"smooth"})},d=()=>{!a||!u.threshold||(c.value=a.scrollTop<=u.threshold)};return J(()=>{a=u.target==="body"?document.documentElement||document.body:document.querySelector(u.target),a&&(a.addEventListener("scroll",d),d())}),X(()=>{a&&a.removeEventListener("scroll",d)}),ee(()=>u.target,T=>{a&&a.removeEventListener("scroll",d),a=T==="body"?document.documentElement||document.body:document.querySelector(T),a&&(a.addEventListener("scroll",d),d())}),(T,P)=>{const p=oe;return k(),K(ne,{name:"van-fade"},{default:te(()=>[I(o("div",{class:"back-to-bottom",style:se({right:l.right,bottom:l.bottom,zIndex:l.zIndex}),onClick:b},[h(p,{name:"down",class:"xia"})],4),[[ae,c.value||!l.threshold]])]),_:1})}}},ye=H(fe,[["__scopeId","data-v-849f4323"]]),_e={class:"page-container"},be={class:"fu"},we={class:"tab-wrapper"},xe={class:"search-header"},ke={class:"search-form"},Te={class:"native-search"},Pe={class:"search-actions"},Ce={class:"card-list list-wrap",id:"list-container"},Se={key:0,class:"loading-tip"},Be={key:1,class:"empty-tip"},ze=["onClick"],Me={class:"card-header"},Ve=["src"],Ne={class:"card-title"},Ee={class:"card-meta"},Le={class:"author"},Ie={class:"date"},$e=["innerHTML"],De={class:"card-stats"},Re={__name:"zhuye",setup(l){const u=_("推荐"),c=_(""),a=_("题干"),b=_(1),d=_(10),T=de(),P=_([]),p=_({total:0,pageTotal:0}),m=_(!1),s=()=>new Promise(t=>{O(()=>{const e=document.getElementById("list-container");e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"}),setTimeout(t,100)})}),i=(t,e)=>{const x=e||u.value;return{current:t||1,pageSize:d.value,stem:a.value==="题干"&&c.value||"",keyWord:a.value==="关键字"&&c.value||"",sorter:"weight_desc"}},v=async t=>{try{m.value=!0;const e=i(1,t),V=(await q(e)).data.total||0,n=Math.ceil(V/d.value)||1;return p.value.total=V,p.value.pageTotal=n,n}catch(e){return console.error("获取总条数失败：",e),z.fail("获取数据总数失败"),1}finally{m.value=!1}},r=async(t=1)=>{try{m.value=!0;const e=i(t),x=await q(e);console.log(`第${t}页返回的面经列表`,x),P.value=x.data.rows||[],p.value.total=x.data.total||0,p.value.pageTotal=Math.ceil(p.value.total/d.value)||1,b.value=t,await s()}catch(e){console.error("获取面经列表失败：",e),P.value=[],z.fail("加载面经失败，请重试")}finally{m.value=!1}},y=t=>{T.push({path:"/mjxianqing",query:{MJID:t,HTURL:"zhuye"}})},w=t=>{b.value=t,r(t)},f=async t=>{u.value=t,m.value=!0;try{if(t==="推荐")await r(1),console.log("切换到推荐，加载第1页");else if(t==="最新"){const e=await v(20);await r(e),console.log(`切换到最新，加载最后一页：${e}`)}}catch(e){console.error("切换标签失败：",e),z.fail("切换标签失败，请重试")}finally{m.value=!1}},B=async()=>{console.log(`【${a.value}】搜索关键词：`,c.value),m.value=!0;try{if(u.value==="最新"){const t=await v();await r(t)}else await r(1)}catch{z.fail("搜索失败，请重试")}finally{m.value=!1}},g=async()=>{c.value="",m.value=!0;try{if(u.value==="最新"){const t=await v();await r(t)}else await r(1)}catch{z.fail("重置搜索失败，请重试")}finally{m.value=!1}};return J(async()=>{await r(1)}),(t,e)=>{const x=ge,V=ve;return k(),C("div",_e,[o("div",be,[o("div",we,[o("div",{class:R(["tab-item",{active:u.value==="推荐"}]),onClick:e[0]||(e[0]=n=>f("推荐"))}," 推荐 ",2),o("div",{class:R(["tab-item",{active:u.value==="最新"}]),onClick:e[1]||(e[1]=n=>f("最新"))}," 最新 ",2)])]),o("div",xe,[e[6]||(e[6]=o("div",{class:"title-text"},"面经",-1)),I(o("select",{class:"search-select","onUpdate:modelValue":e[2]||(e[2]=n=>a.value=n)},[...e[5]||(e[5]=[o("option",{value:"题干"},"题干搜索",-1),o("option",{value:"关键字"},"关键字搜索",-1)])],512),[[le,a.value]]),o("div",ke,[o("div",Te,[I(o("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>c.value=n),placeholder:"请输入搜索关键词",class:"search-input",onKeyup:re(B,["enter"])},null,544),[[ce,c.value]]),o("div",Pe,[c.value?(k(),C("button",{key:0,class:"cancel-btn",onClick:g},"取消")):U("",!0),o("button",{class:"search-btn",onClick:B},"搜索")])])])]),o("div",Ce,[m.value?(k(),C("div",Se,"加载中...")):P.value.length===0?(k(),C("div",Be,"暂无面经数据")):(k(!0),C(ie,{key:2},ue(P.value,n=>(k(),C("div",{class:"interview-card",key:n.id,onClick:Ue=>y(n.id)},[o("div",Me,[o("img",{class:"avatar",src:n.avatar||"https://picsum.photos/40/40",style:{background:"linear-gradient(45deg, #ff5252 0%, #4caf50 100%)","border-radius":"50%"},alt:"头像"},null,8,Ve),o("div",Ne,M(n.stem),1)]),o("div",Ee,[o("span",Le,M(n.author||n.stem),1),o("span",Ie,M(n.createdAt),1)]),o("div",{class:"card-content",innerHTML:n.content},null,8,$e),o("div",De,[o("span",null,"点赞 "+M(n.likeCount||0),1),o("span",null,"浏览 "+M(n.views||0),1)])],8,ze))),128)),p.value.total>0?(k(),K(x,{key:3,modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=n=>b.value=n),"total-items":p.value.total,"page-size":d.value,"show-page-size":3,"force-ellipses":"",class:"dibu",onChange:w},null,8,["modelValue","total-items","page-size"])):U("",!0),h(ye,{right:"10vw",bottom:"25vh",target:"#list-container",threshold:"650"}),h(V,{right:"10vw",bottom:"20vh"})])])}}},Je=H(Re,[["__scopeId","data-v-997729b4"]]);export{Je as default};
